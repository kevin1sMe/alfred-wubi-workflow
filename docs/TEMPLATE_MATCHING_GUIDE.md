# 模板匹配 (Template Matching) 指南

本文档介绍了本项目中使用的最基础但针对性极强的验证码识别方案：**模板匹配**。

## 1. 原理说明

模板匹配是一种基于像素点比对的计算机视觉技术。
在本项目中，我们预先收集了大量已知的单字符图片（0-9），作为"模板库"。

当需要识别一个新的验证码时，程序执行以下步骤：
1.  **切割**：将 4 位验证码图片切割成 4 个独立的字符图片。
2.  **比对**：将每个切割下来的字符图片与模板库中的所有图片逐一进行像素级比对（计算差异值）。
3.  **匹配**：找到差异值最小（最相似）的那个模板，其文件名即为识别结果。

## 2. 优缺点分析

| 特点 | 说明 |
| :--- | :--- |
| **优点** | 1. **实现简单**：无需训练神经网络，逻辑直观。<br>2. **对特定字体极准**：如果验证码字体固定且无形变，准确率可达 100%。<br>3. **无需显卡**：纯 CPU 计算。 |
| **缺点** | 1. **抗干扰差**：对噪点、旋转、缩放、字体变化极其敏感。<br>2. **依赖分割**：必须能准确地将字符切割开（粘连字符无法处理）。<br>3. **维护成本**：如果验证码样式微调，需要重新收集所有模板。 |

## 3. 在本项目中的应用

### 3.1 核心代码
相关逻辑位于 `captcha_ocr_test.py` 文件中：
*   `CaptchaSolver` 类负责加载模板。
*   `solve` 方法执行切割和匹配。

### 3.2 模板库
模板存储在 `captcha_templates/` 目录下。文件名格式如 `3-9.bmp`，表示这是数字 `3` 的第 9 个样本。

### 3.3 实际表现
在我们的测试集 `test_verification/` 中：
*   **准确率**：约 **50% - 100%**（很不稳定）。在第一批测试中达到 100%，但在包含更多形变数字的第二批测试中降至 50%。
*   **主要问题**：容易混淆形状相似的数字（如 `3` 和 `8`，`0` 和 `9`），尤其是当像素点有微小偏移时。

## 4. 优化建议
*   **扩充模板库**：遇到识别错误的字符，将其保存下来加入模板库，可以立竿见影地修复特定错误。
*   **优化切割算法**：目前的固定宽度切割可能不适用于字符宽度变化的场景，可以改进为基于连通域的切割。
